function e(e,t,r,s){Object.defineProperty(e,t,{get:r,set:s,enumerable:!0,configurable:!0})}e(module.exports,"syncFetch",()=>s),e(module.exports,"fetchAction",()=>i),e(module.exports,"fetchBook",()=>a),e(module.exports,"fetchMovie",()=>n),e(module.exports,"fetchGame",()=>o),e(module.exports,"fetchSong",()=>m),e(module.exports,"fetchData",()=>u);var t={};t=JSON.parse('{"name":"idouban","version":"1.1.2","description":"Inject douban pages in your site.","main":"dist/http.js","targets":{"main":{"source":"src/http.ts","distDir":"dist/","optimize":true},"js":{"source":"src/index.ts","context":"browser","distDir":"dist/","optimize":true},"css":{"source":"src/index.css","context":"browser","distDir":"dist/","optimize":true}},"scripts":{"start":"parcel serve -p 8888 src/index.html --dist-dir build/","build":"parcel build --no-source-maps"},"files":["dist"],"dependencies":{"i18next":"^23.11.5","react":"^18.3.1","react-dom":"^18.3.1"},"devDependencies":{"@types/react":"^18.3.3","@types/react-dom":"^18.3.0","parcel":"^2.12.0","process":"^0.11.10"},"engines":{"node":">= 18"},"bugs":{"url":"https://github.com/mythsman/idouban/issues"},"homepage":"https://github.com/mythsman/idouban/","repository":{"type":"git","url":"git+https://github.com/mythsman/idouban.git"},"keywords":["douban"],"author":"mythsman","license":"MIT"}');const r=e=>{switch(e){case 1:return"poor";case 2:return"fair";case 3:return"good";case 4:return"great";case 5:return"best";default:return""}},s=async(e,r)=>{try{let s={"User-Agent":`${t.name}@${t.version}`};return r&&(s.Referer=r),(await fetch(e,{method:"GET",headers:s})).json()}catch(e){return console.error(e),"OFFLINE"}},i=async(e,t,r,s)=>{switch(s){case"book":return a(e,t,r);case"movie":return n(e,t,r);case"game":return o(e,t,r);case"song":return m(e,t,r);default:throw Error(`${s} type not found`)}},a=async(e,t,i)=>{let a=[],o=await s("https://mouban.mythsman.com/guest/user_book?action="+t+"&id="+e,i);if("OFFLINE"===o)return console.warn("Cannot connect to server"),a;for(let e of o.result.comment){let t=[];e.item.author&&t.push(e.item.author),e.item.translator&&t.push(e.item.translator),e.item.press&&t.push(e.item.press),e.item.producer&&t.push(e.item.producer);let s=[];e.mark_date&&s.push(e.mark_date),e.label&&s.push(e.label),a.push({title:e.item.title,alt:"https://book.douban.com/subject/"+e.item.douban_id+"/",image:e.item.thumbnail,meta:t.join(" / "),mark:s.join(" / "),rate:r(e.rate),comment:e.comment})}return a},o=async(e,t,i)=>{let a=[],o=await s("https://mouban.mythsman.com/guest/user_game?action="+t+"&id="+e,i);if("OFFLINE"===o)return console.warn("Cannot connect to server"),a;for(let e of o.result.comment){let t=[];e.item.platform&&t.push(e.item.platform),e.item.genre&&t.push(e.item.genre),e.item.developer&&t.push(e.item.developer),e.item.publisher&&t.push(e.item.publisher);let s=[];e.mark_date&&s.push(e.mark_date),e.label&&s.push(e.label),a.push({title:e.item.title,alt:"https://www.douban.com/game/"+e.item.douban_id+"/",image:e.item.thumbnail,meta:t.join(" / "),mark:s.join(" / "),rate:r(e.rate),comment:e.comment})}return a},m=async(e,t,i)=>{let a=[],o=await s("https://mouban.mythsman.com/guest/user_song?action="+t+"&id="+e,i);if("OFFLINE"===o)return console.warn("Cannot connect to server"),a;for(let e of o.result.comment){let t=[];e.item.alias&&t.push(e.item.alias),e.item.musician&&t.push(e.item.musician),e.item.album_type&&t.push(e.item.album_type),e.item.genre&&t.push(e.item.genre),e.item.media&&t.push(e.item.media),e.item.publisher&&t.push(e.item.publisher),e.item.publish_date&&t.push(e.item.publish_date);let s=[];e.mark_date&&s.push(e.mark_date),e.label&&s.push(e.label),a.push({title:e.item.title,alt:"https://music.douban.com/subject/"+e.item.douban_id+"/",image:e.item.thumbnail,meta:t.join(" / "),mark:s.join(" / "),rate:r(e.rate),comment:e.comment})}return a},n=async(e,t,i)=>{let a=[],o=await s("https://mouban.mythsman.com/guest/user_movie?action="+t+"&id="+e,i);if("OFFLINE"===o)return console.warn("Cannot connect to server"),a;for(let e of o.result.comment){let t=[];e.item.style&&t.push(e.item.style),e.item.director&&t.push(e.item.director),e.item.writer&&t.push(e.item.writer),e.item.actor&&t.push(e.item.actor),e.item.publish_date&&t.push(e.item.publish_date);let s=[];e.mark_date&&s.push(e.mark_date),e.label&&s.push(e.label),a.push({title:e.item.title,alt:"https://movie.douban.com/subject/"+e.item.douban_id+"/",image:e.item.thumbnail,meta:t.join(" / "),mark:s.join(" / "),rate:r(e.rate),comment:e.comment})}return a},u=async(e,t,r,a)=>{let o=await s("https://mouban.mythsman.com/guest/check_user?id="+e,t);if("OFFLINE"===o)return console.warn("Cannot connect to server"),a.map(e=>({action:e,items:[]}));if(!o.success)return console.warn(o.msg),a.map(e=>({action:e,items:[]}));let m=[];for(let s of a){let a=await i(e,s,t,r);m.push({action:s,items:a})}return m};